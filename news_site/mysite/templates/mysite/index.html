{% extends 'mysite/base.html' %}
{% block title %} сайт {% endblock %}
{% block body %}
    {{ request.user }}<br>
    <br>
    <a href="{% url 'register' %}"><button>Регистрация</button></a>
    <a href="{% url 'login' %}"><button>Вход</button></a>
    <a href="{% url 'logout' %}"><button>Выход</button></a><br>
    <br>
    {% load auth_extras %}
    {% if request.user.is_authenticated %}
        {% if request.user|has_group:"admins" %}
            <a href="{% url 'edit_topics' %}"><button>Редактировать темы</button></a>
        {% endif %}
        {% if request.user|has_group:"admins" or request.user|has_group:"editors" %}
            <a href="{% url 'edit_articles' %}"><button>Редактировать статьи</button></a>
        {% endif %}
    {% endif %}

<!--    {% regroup articles by topic as topics_list %}-->
<!--    <ul>-->
<!--    {% for topic in topics_list %}-->
<!--        <li>{{ topic.grouper }}-->
<!--            <ul>-->
<!--                {% for item in topic.list %}-->
<!--                  <li>{{ item }}</li>-->
<!--                {% endfor %}-->
<!--            </ul>-->
<!--        </li>-->
<!--    {% endfor %}-->
<br>
{% regroup post_list by topic as topics_list %}
<ul>
{% for topic in topics_list %}
    <li>{{ topic.grouper }}
        <ul>
            {% for item in topic.list %}
                <li><a href="{% url 'article' item.id %}">{{ item }}</a></li>
            {% endfor %}
        </ul>
    </li>
{% endfor %}
</ul>

{% if post_list.has_other_pages %}
    {% if post_list.has_previous %}
    <a href="?page={{ post_list.previous_page_number }}" class="page-link">&laquo; PREV </a>
    {% endif %}
    {% if post_list.has_next %}
    <a href="?page={{ post_list.next_page_number }}" class="page-link"> NEXT &raquo;</a>
   {% endif %}
{% endif %}

<!--    <ul>-->
<!--        <h3>темы</h3>-->
<!--        {% for topic in topics %}-->
<!--            <li>-->
<!--                <a href="{% url 'topic' %}?id={{ topic.id }}">{{ topic }}</a>-->
<!--            </li>-->
<!--        {% endfor %}-->
<!--        <h3><a href="{% url 'without_topic' %}">статьи без темы</a></h3>-->
<!--    </ul>-->
{% endblock %}
